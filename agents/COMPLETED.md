# Completed Tasks

Append-only archive. Each entry: `[date] T-XXXX: Title (agent)` or historical `[date] Description`.

---
- [2026-02-20] T-0245/T-0239/T-0243/T-0244: Code health sprint round 3 — BattleActionExecutor static class deduplicates attack/ability execution between ActionExecuteState and EnemyTurnState; _connect_battler_signals() helper in battle_scene; _create_popup_label() helper in hud.gd replaces 6 duplicate setup blocks; EventFlagRegistry centralizes all 17 flag string constants, replacing inline literals in 3 scene/event files; 18 new tests (claude)
- [2026-02-20] T-0237/T-0238/T-0240/T-0241/T-0242: Code health sprint round 2 — AudioManager _do_crossfade() helper eliminates 17 lines of copy-paste; enemy_turn_state.enter() broken into _handle_attack/ability/defend/wait_action helpers + ENEMY_TURN_DELAY constant; equipment_manager SLOT_KEYS constant; quest_manager.deserialize() split into _restore_active/completed/failed_quests; pause_menu _hide_for_subscene/_restore_from_subscene helpers; no behavior changes, all tests pass (claude)
- [2026-02-20] T-0233/T-0234/T-0235/T-0236: Code health sprint — fix gdlint violations (unused-argument, line-length), remove 4 dead Battler wrapper methods + migrate test call sites, eliminate ScenePaths const duplication in game_manager.gd, centralize 9 resonance/inner-panel Color literals into UITheme; also removed dead @onready vars in pause_menu/shop_ui/skill_tree_ui; 0 behavior changes, all tests pass (claude)
- [2026-02-20] T-0228/T-0229/T-0230/T-0231/T-0232: Test suite cleanup sprint — removed ~150 low-value tests (constant-value assertions, enum ordinals, has_signal/has_method reflection checks, brittle dialogue text assertions, tilemap dimension data tests, animation constant checks); slimmed 12 event files to contract/logic only; slimmed roothollow/verdant-forest NPC dialogue tests to flag-routing invariants; consolidated 15 playtest action registry tests into 1; deleted 5 entire low-value test files (test_battler_idle_anim, test_defeat_bgm, test_level_up_bgm, test_overgrown_ruins_tilemap, test_roothollow_maps); all 1800 tests passing (claude)
- [2026-02-20] T-0192: LastGardenerEncounter event (last_gardener_encounter.gd) — 3-branch choice encounter; peaceful pass / Greenhouse Seed quest unlock / boss fight; 6-line approach dialogue with choice prompt; gated by lyra_fragment_2_collected; trigger zone at col 20 row 3 in overgrown_capital.gd; 17 tests (1708 total); PR #263 (claude)
- [2026-02-20] T-0200: LeavingCapital event (leaving_capital.gd) — 9-line post-dungeon dialogue at Capital exit gate; Garrick grieves two million, Iris names the Severance a deliberate choice, Kael links Lyra's "I'm sorry" to the end; fires before scene transition to Verdant Forest; monitoring=false guard on exit zone; 12 tests (1720 total); PR #264 (claude)
- [2026-02-20] T-0205: Mother's Comfort + First Day of School echo interactables in Overgrown Capital Residential Quarter; first_day_of_school.tres EchoData; compute_residential_echo_positions() + compute_*_vision_lines(); _setup_residential_echoes() wired in _ready(); 14 tests (1745 total); PR #268 (claude)
- [2026-02-20] T-0199: Morning Commute + Family Dinner echo interactables in Overgrown Capital Market District; compute_market_echo_positions() + compute_*_vision_lines(); _setup_market_echoes() wired in _ready(); 11 tests (1731 total); PR #266 (claude)
- [2026-02-20] T-0193: AfterCapitalCamp event (after_capital_camp.gd) — 15-line campfire scene compressing Chapter 5 Camp Scene; Iris/Garrick shared guilt, Kael "Neither of you is that person anymore"; gated by lyra_fragment_2_collected; wired in verdant_forest.gd via call_deferred; 15 tests (1691 total); PR #262 (claude)
- [2026-02-20] T-0212: Wire Verdant Forest → Overgrown Capital transition — ExitToCapital Area2D (320,8) + SpawnFromCapital Marker2D (320,48) in Forest, spawn_from_forest group in Capital, fix Capital exit to SP.VERDANT_FOREST, ZoneMarker.UP; 10 tests; PR #257 (claude)
- [2026-02-20] T-0209: Add Echo Nomad enemy to Overgrown Capital encounter pool — echo_nomad.tres (90 HP, magic-biased, AGGRESSIVE, ghost1.png), updated build_pool() with optional 3rd param, 4 new tests (9 total); PR #256 (claude)
- [2026-02-20] T-0210: Wire Echoes of the Capital BGM for Overgrown Capital — replaced Castle.ogg placeholder, added 1 regression test + updated BGM coverage test; PR #255 (claude)
- [2026-02-20] T-0184: Seed skill tree .tres files for all 8 party members — 24 SkillTreeData files (12 full 6-node trees for Kael/Iris/Garrick/Nyx, 12 stub 3-node trees for Lyra/Sienna/Cipher/Ash), 4 CharacterData .tres updated with skill_trees refs, 10 tests; PR #254 (claude)
- [2026-02-20] T-0196: Add OVERGROWN_CAPITAL constant to ScenePaths — Dungeon scenes section, path constant, 1 new test (1598 total). PR #252 (claude)
- [2026-02-20] T-0201: Place childs_laughter echo interactable in Verdant Forest — CHILDS_LAUGHTER_ECHO_ID constant, compute_forest_echo_position() helper (352,192), MemorialEchoStrategy with vision_lines, one_time=true; 6 tests; 1597 total. PR #251 (claude)
- [2026-02-20] T-0197: Seed Story Echo .tres files — morning_commute/family_dinner (Common), warning_ignored (Uncommon), the_first_crack (Rare); all UNIQUE_ECHO type, uses_per_battle=0; lore authored from echo catalog + design docs; 12 tests; 1591 total. PR #250 (claude)
- [2026-02-20] T-0198: Refactor MemorialEchoStrategy for generic echo placement — require_quest_id export (empty=generic, set=quest-gated), vision_lines export for configurable dialogue, compute_should_collect() static pure helper, has_been_used read guard, push_warning for odd vision_lines, verdant_forest.tscn updated with require_quest_id=elder_wisdom; 8 tests; 1579 total. PR #249 (claude)
- [2026-02-20] T-0100: NPC idle animations — BREATHE_SCALE_DELTA=0.03/BREATHE_HALF_DURATION=1.1s scale.y breathing tween, HEAD_TURN_MIN=3.5s/MAX=8.0s random flip_h head turn via SceneTreeTimer; start/stop wired to _ready/_on_dialogue_ended/interact; 8 tests (1438 total) (claude)
- [2026-02-20] T-0141: Settings menu accessibility — compute_slider_tooltip() pure helper (master/bgm/sfx descriptions), ↺ reset-to-default buttons per slider, "← → keys: adjust" keyboard hint label; 4 new tests (1430 total) (claude)
- [2026-02-20] T-0155: Wire victory dismiss prompt to InputMap — compute_dismiss_prompt_from_events() pure helper extracts key/button labels from InputEvent array, compute_dismiss_prompt_text() reads live InputMap.action_get_events() with has_action guard; 3 new tests (1426 total) (claude)
- [2026-02-20] T-0127: Playtime display on title screen — compute_playtime_str(seconds) formats as "HH:MM" (empty for <60s), compute_save_summary() gains playtime_str key, _show_save_label() includes playtime between location and date; 7 tests (1423 total) (claude)
- [2026-02-20] T-0172: BanterManager scaffold — static RefCounted class with BANTERS registry (key/gate/party/locations), compute_eligible_banters(party_ids, flags, location) returns eligible keys, bond_01_knife_lessons registered; 8 tests (1416 total) (claude)
- [2026-02-20] T-0174: Iris personal quest stub — iris_engineers_oath.tres (QuestData "The Engineer's Oath: Pending", CHARACTER type), IRIS_QUEST_PATH constant + compute_should_auto_accept_iris_quest() static helper in iris_recruitment.gd, auto-accept after post-battle dialogue; 3 new tests (1408 total) (claude)
- [2026-02-20] T-0173: Garrick personal quest stub — garrick_three_burns.tres (QuestData "Something He Carries", CHARACTER type), GARRICK_QUEST_PATH constant + compute_should_auto_accept_garrick_quest() static helper in garrick_recruitment.gd, auto-accept on recruitment; 3 new tests (1405 total) (claude)
- [2026-02-20] T-0175: BGM pop/restore fade-in — BGM_RESTORE_FADE_TIME=0.5s constant, compute_bgm_restore_fade_duration() static helper, pop_bgm() cold-start else branch tweens volume from -80.0 to _bgm_volume_db; 2 new tests (1402 total) (claude)
- [2026-02-20] T-0164: Wire party_changed signal into party_ui — _connect/_disconnect_party_signals() with is_connected guard, _on_party_changed() live rebuild, removed redundant manual _build_ui() after swap; 5 new tests (1400 total) (claude)
- [2026-02-20] T-0169: BOND-01 Knife Lessons banter — VerdantForestBond01Dialogue static module (5-line Iris/Kael knife grip scene), compute_bond01_eligible() helper, wired via call_deferred in verdant_forest.gd; 13 new tests (1395 total) (claude)
- [2026-02-20] T-0170: Innkeeper night event priority — RootHollowNightEvents static helper (GarrickNightScene > CampThreeFires priority), roothollow.gd if/elif dispatch replaces dual-if bug; 11 new tests (1382 total) (claude)
- [2026-02-20] T-0096: Particle effects for healing/resonance/crits — BattleParticles static module (resonance flash colors, crit flash color/duration), resonance_state_changed wired in PartyBattlerScene, scene-wide crit flash in ActionExecuteState; 11 new tests (1371 total) (claude)
- [2026-02-20] T-0138: Scrollable battle log — BattleUILog.compute_log_entry() static helper extracted from battle_ui.gd; scroll_following=true already in .tscn; 7 new tests (1287 total) (claude)
- [2026-02-20] T-0162: Verdant Forest traversal dialogue — VerdantForestDialogue static module (get_traversal_lines/flag/gate_flag), _maybe_trigger_traversal_dialogue via call_deferred in verdant_forest.gd, 4-line scene with Garrick/Iris/Kael; 9 new tests (1296 total) (claude)
- [2026-02-20] T-0163: Party swap validation feedback — compute_swap_feedback_text() in party_ui_data.gd, _show_swap_error() tween flash + transient label in party_ui.gd; 5 new tests in test_party_ui_feedback.gd (1301 total) (claude)
- [2026-02-20] T-0148: Camp scene "Three Around a Fire" — CampThreeFires event script (15-line Garrick/Iris/Kael campfire dialogue), wired into roothollow.gd innkeeper handler on garrick_recruited flag; 12 new tests (1313 total) (claude)
- [2026-02-20] T-0135: Garrick night scene — GarrickNightScene event script (10-line quiet reflection at Roothollow: shield monologue, Kael comparison, Iris anger), gated by garrick_met_lyra flag; 12 new tests (1325 total) (claude)
- [2026-02-20] T-0137: Roothollow market expansion — RootHollowShop.compute_item_paths() module, Forest Remedy (HEAL_HP 80) and Crystal Wick (HEAL_EE 30) unlock after iris_recruited; 7 new tests (1332 total) (claude)
- [2026-02-20] T-0171: Overgrown Capital entry scene — OvergrownRuinsEntryDialogue static module (7-line gate dialogue: Kael awe, Iris crystal density, Garrick grief for two million, navigation call), gated by garrick_recruited, fires once via overgrown_capital_entry_seen; 13 new tests (1345 total) (claude)
- [2026-02-20] T-0093: Fragment tracker compass UI — HudFragmentTracker static module (compute_signal_direction/compute_tracker_display), directional arrow label in HUD top-right gated by opening_lyra_discovered/garrick_met_lyra, refreshes on scene_changed and OVERWORLD state; 15 new tests (1360 total) (claude)
- [2026-02-20] T-0098: Add overworld encounter warning — two-phase encounter_warning→encounter_triggered flow with 0.8s delay; yellow screen flash in Verdant Forest and Overgrown Ruins (claude)
- [2026-02-20] T-0078: AssetLoader static utility — load_sfx/bgm/texture/scene/resource with exists() guard + push_warning, 10 tests, PR merged (claude)
- [2026-02-20] T-0061: Overgrown Ruins debris layer & z-index fix — GroundDebris layer, Walls/Objects z_index 0 (was -1), walls now visible, 5 tests, PR merged (claude)
- [2026-02-20] T-0058: Screen shake on heavy damage — BattleShake static utility (is_heavy_hit, compute_intensity, shake), 25% HP threshold, 3–7px intensity, wired in action_execute_state, 10 tests, PR merged (claude)
- [2026-02-20] T-0160: Quest-NPC indicator refresh — compute_npc_indicator_type() in roothollow_quests.gd, QuestManager signal wiring in roothollow _ready(), 7 tests, PR #201 (claude)
- [2026-02-20] T-0057: Turn order display — compute_turn_order_entries() static helper, [Active] brackets with ACTIVE_HIGHLIGHT, ally=blue enemy=red, 6 tests, PR #200 (claude)
- [2026-02-20] T-0165: Party UI cross-column keyboard/gamepad focus nav — compute_cross_column_focus_index() helper, _setup_focus() two-column rewrite, 5 tests, PR #199 (claude)
- [2026-02-20] T-0166: BUG defend stance persists through TurnEnd — removed is_defending=false from end_turn(), cleared in PlayerTurnState.enter(); 4 tests updated, PR #198 (claude)
- [2026-02-20] T-0133: Save slot summary on Continue button — timestamp in gather_save_data, compute_save_summary/format_save_timestamp static helpers, _show_save_label programmatic label below ContinueButton, 8 tests, PR #197 (claude)
- [2026-02-20] T-0132: Add DEF badge on party battler panels — DEFEND_BADGE_COLOR, compute_defend_badge() static helper, wired in _create_party_row, fixed TurnEnd/PlayerTurnState timing for badge visibility, 4 tests, PR #196 (claude)
- [2026-02-20] T-0149: Add Spring Shrine interactable south of Roothollow — RoothollowZone module with compute_garrick_zone_can_trigger/compute_shrine_marker_visible, shrine direction label, 8 tests (claude)
- [2026-02-20] T-0159: Fix Verdant Forest south canopy gap — CANOPY_MAP rows 15-22 filled with 88 type-matched 2x2 canopy tiles above 22 south-half trunks, 6 tests (claude)
- [2026-02-20] T-0020: Build party management UI — party_ui_data.gd (compute_member_display/compute_swap_valid/compute_panel_sections), party_ui.gd (Control sub-screen, two-column active/reserve swap), pause_menu wired, 15 tests, PR #194 (claude)
- [2026-02-20] T-0101: Party formation and swap UI — compute_equipment_slots helper, character detail panel in party_ui showing stats + equipment slots, 5 new tests, PR #195 (claude)
- [2026-02-20] T-0099: Zone transition animations — TransitionType enum (FADE/SLIDE_LEFT/SLIDE_RIGHT), SLIDE_DURATION=0.4, compute_transition_type() static pure helper, _run_slide_transition() black ColorRect wipe, _run_fade_transition() refactored, _apply_spawn_point() extracted; 7 new tests (1445 total) (claude)
- [2026-02-20] T-0102: Zone compass in HUD — HudCompass static module (compute_compass_text/compute_compass_visible), ZONE_NEIGHBORS adjacency map, Unicode arrows, _setup_compass()/_update_compass() in hud.gd, bottom-left persistent label; 12 tests (1457 total) (claude)
- [2026-02-20] T-0140: AudioManager SFX priority — SfxPriority enum (CRITICAL/NORMAL/AMBIENT), compute_sfx_player_index() pure static helper, play_sfx() updated with backward-compatible priority param; 11 tests (1470 total) (claude)
- [2026-02-20] T-0176: Reconcile BACKLOG.md — bulk-updated 72 task statuses from todo/in-progress to done; added T-0177/T-0178/T-0179 to backlog; doc-only change (claude)
- [2026-02-20] T-0177: Wire SfxPriority.CRITICAL to combat death and crit SFX — CRITICAL_PRIORITY_PATHS + compute_sfx_priority() in SfxLibrary; action_execute_state + enemy_turn_state updated; 8 tests (1478 total) (claude)
- [2026-02-20] T-0018: Build skill tree framework — SkillTreeNodeData + SkillTreeData Resources, SkillTreeManager static utility (compute_can_unlock/compute_unlock_result), CharacterData skill_points + unlocked_skill_ids + skill_trees, LevelManager awards 1 SP/level; 17 tests (1495 total) (claude)
- [2026-02-20] T-0179: Add interaction prompt near player — InteractionHint static helper (compute_interaction_hint_text) reads InputMap for bound key; player._update_interaction_prompt() each physics frame; fallback '[ ] Interact'; 5 tests (1500 total) (claude)
- [2026-02-20] T-0023: Implement camp/rest system — CampMenuData static helper, CampMenu script-only Control (Rest+Leave Camp, push/pop MENU state), CampStrategy Resource; 10 tests (1510 total) (claude)
- [2026-02-20] T-0178: Add read-only control bindings display to settings menu — compute_control_bindings()/compute_action_label()/compute_action_key_label() in SettingsData; GridContainer Controls section; 8 tests (1518 total); PR #240 (claude)
- [2026-02-20] T-0026: Build debug console — DebugCommands static class; CanvasLayer UI with LineEdit (backtick toggle, layer=100); 5 commands (heal_all/set_level/add_item/teleport/set_flag); OS.is_debug_build() guard; 18 tests (1536 total); PR #241 (claude)
- [2026-02-20] T-0180: Place campfire interactable in Verdant Forest — CampStrategy Interactable at Vector2(320,208); one_time=false; 6 tests; PR #242 (claude)
- [2026-02-20] T-0181: M0 hygiene sweep — class_name BattleScene; typed BattleManager._battle_scene; removed 4 has_method guards in SaveManager; PR #243 (claude)
- [2026-02-20] T-0182: EchoManager autoload — collect/has/count/serialize/deserialize/signal; registered in project.godot; SaveManager gains echo_mgr param; HUD echo badge; 16 tests; PR #244 (claude)
- [2026-02-20] T-0189: Wire EchoManager into all SaveManager save/load call sites — 3 new round-trip tests; 1558 total; PR #246 (claude)
- [2026-02-20] T-0187: Echo Collection Journal UI — script-only EchoJournal Control; Echoes button in pause menu; rarity badge, type tag, lore text, Kael's Notes detail panel; 10 tests; 1571 total; PR #248 (claude)
- [2026-02-20] T-0190: Overgrown Capital dungeon skeleton — 40x28 tilemap, GroundDebris layer, Memory Bloom + Creeping Vine encounter pool, SpawnFromRuins marker, camera limits, boundary walls, Castle.ogg BGM; 15 tests (1586 total); PR #253 (claude)
- [2026-02-20] T-0195: Purification Node mechanic — PurificationNodeStrategy + node_cleared signal + EventFlags; 2 nodes wired in Overgrown Capital; runtime StaticBody2D crystal walls; 10 tests (1648 total); PR #258 (claude)
- [2026-02-20] T-0191: Lyra Fragment 2 collectible + Research Quarter vision sequence — lyra_fragment_2.tres (RARE/UNIQUE_ECHO); MemorialEchoStrategy at (448,96); 10-pair vision (nameplate + 140-day countdown + apology); 8 tests (1656 total); PR #259 (claude)
- [2026-02-20] T-0221: Seed AbilityData .tres for Kael — adaptive_strike/echo_fusion/reality_anchor/convergence_touch; 7 tests (1663 total); PR #260 (claude)
- [2026-02-20] T-0219: Build skill tree UI screen — SkillTreeUI script-only Control; compute_skill_tree_entries/compute_node_state/compute_sp_label; Skills button in pause menu; 13 tests (1676 total); PR #261 (claude)
- [2026-02-20] T-0211: Tilemap visual design for Overgrown Capital — GROUND/DETAIL/DEBRIS/WALL/OBJECTS/ABOVE_PLAYER maps; 9 new tests; PR merged (claude)
- [2026-02-20] T-0224: Place save point interactables in Overgrown Capital — Market (col 10, row 23) + Research (col 28, row 7); 6 new tests; PR #270 (claude)
- [2026-02-20] T-0222: Seed AbilityData .tres for Iris and Garrick — 5 Iris + 5 Garrick abilities; 10 tests (1770 total); PR #271 (claude)
- [2026-02-20] T-0225: Nyx introduction cutscene — NyxIntroduction event, 24-line dialogue, gate flags garrick_recruited + lyra_fragment_2_collected; 14 tests (1785 total); PR #272 (claude)
- [2026-02-20] T-BGM-01: AudioManager BGM pause fix + full OST library wiring — PROCESS_MODE_ALWAYS; defeat/level-up/echo BGMs; character themes via push/pop; 49 tracks OGG-converted; 12 tests (1800 total); PR #273 (claude)
- [2026-02-20] T-0077: Split verdant_forest.gd and overgrown_ruins.gd — VerdantForestMap, VerdantForestEncounters, OvergrownRuinsMap, OvergrownRuinsEncounters modules; 11 tests (1265 total) (claude)
- [2026-02-20] T-0168: Wire enemy crit routing — BattlerDamage.roll_crit(enemy.luck) in EnemyTurnState; crit SFX + popup; 6 tests (1271 total) (claude)
- [2026-02-20] T-0130: Live playtime accumulation — GameManager.playtime_seconds; compute_should_tick_playtime() (OVERWORLD/MENU only); SaveManager wired; 9 tests (1280 total) (claude)
- [2026-02-20] T-0049: Verdant Forest camera limit regression guard — 1 new test (1458 total) (claude)
